<!DOCTYPE html>
<html>
  <head>
    <title>Android training - Broadcast exercises</title>
    <meta charset='utf-8'>
    <script src='../res/slides.js'></script>
  </head>
  <body style='display: none'>
    <section class='slides layout-regular template-default'>
    
<article>
<!-- ==================================================== -->

<h1>Broadcast exercises</h1>  
   
<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Exercise 1 : register a broadcast in the manifest</h3>
<ul>
  <li>Create a new project</li>
  <li>Create a broadcast receiver</li>
  <li>Register the broadcast receiver in the manifest with an intent filter with a custom action</li>
  <li>From the main activity send a broadcast to execute the broadcast receiver created</li>
  <li>Check the logs</li>
</ul>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 1</h3>
<p>Declare the receiver in the manifest with custom action StartAction</p>
<pre><code>&lt;receiver
  android:name=".CustomReceiver" &gt;
  &lt;intent-filter &gt;
      &lt;action android:name="StartAction" /&gt;
  &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 1</h3>
<p>Create a new BroadcastReceiver</p>
<pre><code>public class CustomReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
    Log.v("training" , "onReceive");
  }

}
</code></pre>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 1</h3>
<p>Last bit : send the broadcast</p>
<pre><code>Log.v("training", "sending broadcast");
sendBroadcast(new Intent("StartAction"));
</code></pre>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Exercise 2 : register a broadcast in the activity</h3>
<ul>
  <li>From the broadcast receiver of the exercise 1 send a new broadcast</li>
  <li>Catch the new broadcast in the activity</li>
  <li>Check the logs</li>
</ul>
<ul>
  <li><span class="red">Extra : Intercept outgoing calls</span></li>
</ul>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 2</h3>
<p>Send a second broadcast from the Receiver</p>
<pre><code>public class CustomReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
    Log.v("training" , "onReceive");
    context.sendBroadcast(new Intent("WorkDone"));
  }
}
</code></pre>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 2</h3>
<pre><code>@Override
protected void onResume() {
  super.onResume();
  IntentFilter filter = new IntentFilter("WorkDone");
  registerReceiver(workDoneReceiver, filter);
}

protected void onPause() {
  unregisterReceiver(workDoneReceiver);
  super.onPause();
}</code></pre>

<!-- ==================================================== -->
</article><!-- slide separator--><article>
<!-- ==================================================== -->

<h3>Solution 2 - extra</h3>
<p>Register a new BroadcastReceiver in the activity</p>
<pre><code>&lt;receiver
  android:enabled="true"
  android:name="com.novoda.services2.DialerReceiver" &gt;
  &lt;intent-filter android:priority="2147483647" &gt;
      &lt;action android:name=
        "android.intent.action.NEW_OUTGOING_CALL" /&gt;
  &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>

<!-- ==================================================== -->
</article>

    </section>
  </body>
</html>